(()=>{"use strict";var __webpack_modules__={"./src/public/js/jungle_browse_statistics-public.js":
/*!**********************************************************!*\
  !*** ./src/public/js/jungle_browse_statistics-public.js ***!
  \**********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ \"./src/public/js/utils.js\");\n\n(function ($) {\n  'use strict';\n\n  var ws = new WebSocket('ws://127.0.0.1:8088');\n  let ipInfo = jungle_browse_statistics;\n  ws.onopen = () => {\n    // 连接成功后发送消息给前端\n    ws.send(_utils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getCookie('cache_ip') + '-' + ipInfo.page_url);\n  };\n  ws.onclose = event => {\n    console.log('WebSocket连接已关闭');\n  };\n  ws.onerror = error => {\n    console.log('WebSocket连接错误:', error);\n  };\n  ws.onmessage = event => {\n    console.log('接收到服务器消息:', event.data);\n  };\n  // ws.initWebSocket()\n  // 记录访客的所有浏览信息\n  // 发送Ajax请求到服务器端\n  $.post(ipInfo.ajax_url, {\n    action: 'user_cache',\n    page_url: ipInfo.page_url,\n    _ajax_nonce: ipInfo.nonce\n  });\n  window.requestIdleCallback = window.requestIdleCallback || function (callback) {\n    let start = Date.now();\n    return setTimeout(function () {\n      callback({\n        didTimeout: false,\n        timeRemaining: function () {\n          return Math.max(0, 50 - (Date.now() - start));\n        }\n      });\n    }, 1);\n  };\n  window.cancelIdleCallback = window.cancelIdleCallback || function (id) {\n    clearTimeout(id);\n  };\n  function sendData() {\n    let userIsActive = false;\n    let timeoutId;\n    /*****监听用户一切可能的行为， */\n    // 1. 为了避免用户正在活跃中，突然断网（这种类似的用户行为）所以在活跃中的的用户，\n    function resetTimer(action) {\n      // if (action || action.type == 'click') {\n      //     ws.send(action.type + ': ' + utils.getCurentTime());\n      // }\n      clearTimeout(timeoutId);\n      userIsActive = true;\n      timeoutId = setTimeout(() => {\n        userIsActive = false;\n        ws.send('用户没操作啦：' + _utils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getCurentTime());\n      }, 4000);\n    }\n    window.addEventListener('click', resetTimer);\n    window.addEventListener('mousemove', resetTimer);\n    window.addEventListener('keydown', resetTimer);\n    window.addEventListener('scroll', resetTimer);\n    document.addEventListener('visibilitychange', function () {\n      if (document.hidden) {\n        ws.send('离开页面：' + ipInfo.page_url);\n      } else {\n        ws.send('进入页面：' + ipInfo.page_url);\n      }\n    });\n    resetTimer(); // Start the timer\n  }\n\n  function scheduleDataSend() {\n    // 空闲的时候开始执行，不占用客户一切资源，\n    window.requestIdleCallback(() => {\n      sendData();\n    });\n  }\n  scheduleDataSend();\n})(jQuery);\n\n//# sourceURL=webpack:///./src/public/js/jungle_browse_statistics-public.js?")},"./src/public/js/utils.js":
/*!********************************!*\
  !*** ./src/public/js/utils.js ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  // 在这里生成一个唯一的ID\n  generateUid: () => {\n    return Math.random().toString(36).substr(2, 9);\n  },\n  // //设置缓存\n  setCookie: (name, value, days) => {\n    var expires = "";\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n      expires = "; expires=" + date.toUTCString();\n    }\n    document.cookie = name + "=" + (value || "") + expires + "; path=/";\n  },\n  // // 获取缓存\n  getCookie: name => {\n    var nameEQ = name + "=";\n    var ca = document.cookie.split(\';\');\n    for (var i = 0; i < ca.length; i++) {\n      var c = ca[i];\n      while (c.charAt(0) == \' \') c = c.substring(1, c.length);\n      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n    }\n    return null;\n  },\n  //获取当前日期时间\n  getCurentTime: () => {\n    var now = new Date();\n    var year = now.getFullYear(); //年\n    var month = now.getMonth() + 1; //月\n    var day = now.getDate(); //日\n\n    var hh = now.getHours(); //时\n    var mm = now.getMinutes(); //分\n    var ss = now.getSeconds(); //分\n\n    var clock = year + "-";\n    if (month < 10) clock += "0";\n    clock += month + "-";\n    if (day < 10) clock += "0";\n    clock += day + " ";\n    if (hh < 10) clock += "0";\n    clock += hh + ":";\n    if (mm < 10) clock += \'0\';\n    clock += mm + ":";\n    if (ss < 10) clock += \'0\';\n    clock += ss;\n    return clock;\n  }\n});\n\n//# sourceURL=webpack:///./src/public/js/utils.js?')}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(void 0!==n)return n.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,n)=>{for(var t in n)__webpack_require__.o(n,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},__webpack_require__.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/public/js/jungle_browse_statistics-public.js")})();